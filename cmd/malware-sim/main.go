package main

import (
	"fmt"
	"sync"

	"github.com/dhcgn/malware-sim/catcher"
	"github.com/dhcgn/malware-sim/disco"
)

var (
	Version = "DEV"
)

func main() {
	fmt.Println("malware-sim", Version)

	c := catcher.NewCatcher()
	go c.Catching()

	n := disco.NewNetworkDiscovery(c)
	l := disco.NewLocalkDiscovery(c)

	wg := sync.WaitGroup{}

	wg.Add(2)

	go n.Start(&wg)
	go l.Start(&wg)

	wg.Wait()

	c.GenerateReport()

}
