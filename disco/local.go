package disco

import (
	"path/filepath"
	"sync"

	"github.com/dhcgn/malware-sim/catcher"
	"github.com/dhcgn/malware-sim/targetobject"
)

type local struct {
	c *catcher.Catcher
}

// Start implements Disco
func (l *local) Start(wg *sync.WaitGroup) {
	defer wg.Done()

	targets := GetTargets()
	for _, target := range targets {
		l.c.Add(targetobject.New(target))
	}
}

func GetTargets() []string {
	return []string{
		filepath.Join(`$env:USERPROFILE`),
		`C:\`,
	}
}
